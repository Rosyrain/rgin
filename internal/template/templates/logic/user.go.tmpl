package logic

import (
	"{{.ModuleName}}/dao/mysql"
	"{{.ModuleName}}/models"
)

// SignUp 用户注册
func SignUp(p *models.ParamSignUp) error {
	// 1. 检查用户是否存在
	if err := mysql.CheckUserExist(p.Username); err != nil {
		return err
	}

	// 2. 生成用户ID
	// 提示: 可以使用 snowflake 包生成分布式唯一ID
	// 参考示例代码中的 pkg/snowflake/snowflake.go
	userID := int64(0) // 替换为你的ID生成方式

	// 3. 创建用户
	user := &models.User{
		UserID:   userID,
		Username: p.Username,
		Password: p.Password,
	}

	// 4. 保存到数据库
	return mysql.InsertUser(user)
}

// Login 用户登录
func Login(p *models.ParamLogin) (token string, err error) {
	user := &models.User{
		Username: p.Username,
		Password: p.Password,
	}

	// 1. 验证用户名和密码
	if err := mysql.Login(user); err != nil {
		return "", err
	}

	// 2. 生成认证token
	// 提示: 可以使用 jwt 包生成用户认证token
	// 参考示例代码中的 pkg/jwt/jwt.go
	return "your-token-here", nil
}

